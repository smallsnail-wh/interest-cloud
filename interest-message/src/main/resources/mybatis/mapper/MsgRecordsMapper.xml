<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.interest.message.dao.MsgRecordsDao">
    <resultMap id="msgRecordMap"
               type="com.interest.message.model.entity.MsgRecordEntity">
        <id column="id" property="id"/>
        <result column="owner_id" property="ownerId"/>
        <result column="reply_card_id" property="replyCardId"/>
        <result column="reply_time" property="replyTime"/>
        <result column="is_read" property="isRead"/>
        <result column="form" property="form"/>
        <result column="comment_id" property="commentId"/>
    </resultMap>

    <resultMap id="msgModelMap"
               type="com.interest.message.model.response.MsgRecordResponse">
        <id column="id" property="id"/>
        <result column="ownerid" property="ownerid"/>
        <result column="reply_card_id" property="replyCardId"/>
        <result column="replytime" property="replytime"/>
        <result column="isread" property="isread"/>
        <result column="replyUserid" property="replyUserid"/>
        <result column="replyUserHeadimg" property="replyUserHeadimg"/>
        <result column="replyUsername" property="replyUsername"/>
        <result column="replyContent" property="replyContent"/>
        <result column="title" property="title"/>
        <result column="form" property="form"/>
        <result column="comment_id" property="commentId"/>
        <result column="to_id" property="toId"/>
    </resultMap>

    <select id="getUnreadMsgCount" parameterType="Integer" resultType="Integer">
        select count(1) from msg_records
        <where>
            owner_id = #{userId} and is_read = 0
        </where>
    </select>

    <insert id="addMsg" parameterType="MsgRecordEntity">
		insert into msg_records(owner_id, form, comment_id, reply_card_id, reply_time, is_read)
			values(#{ownerId}, #{form}, #{commentId}, #{replyCardId}, #{replyTime}, #{isRead});
	</insert>

</mapper>